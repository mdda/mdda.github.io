---
date: 2019-07-15
title: Upgrading to Fedora 30
tagline: virtualenv set-up
category: OSS
tags:
- fedora
- python
- tensorflow
- pytorch
layout: post
published: false
---
{% include JB/setup %}

### Fedora 30 now has Python 3.7

So let's rebuild our `virtualenv` : 

{% highlight bash %}
sudo dnf install python3-virtualenv

. env37/bin/activate
pip3 install https://download.pytorch.org/whl/cu100/torch-1.1.0-cp37-cp37m-linux_x86_64.whl
pip3 install https://download.pytorch.org/whl/cu100/torchvision-0.3.0-cp37-cp37m-linux_x86_64.whl

pip install tf-nightly-gpu-2.0-preview  # 8hrs old...
{% endhighlight %}


#### Test that it works

{% highlight python %}
import torch

#dtype = torch.FloatTensor  # Use this to run on CPU
dtype = torch.cuda.FloatTensor # Use this to run on GPU

a = torch.Tensor( [[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]]).type(dtype)
b = torch.Tensor( [[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]]).type(dtype)

print(a.mm(b).device)  # matrix-multiply (should state : on GPU)
#cuda:0

## And now tensorflow (has to be second, because it's "greedy")
import tensorflow as tf

tf.debugging.set_log_device_placement(True)

a = tf.constant([[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]], shape=[2, 3], name='a')
b = tf.constant([[1.0, 2.0], [3.0, 4.0], [5.0, 6.0]], shape=[3, 2], name='b')
c = tf.matmul(a, b)

# Eager mode FTW!
print(c)

# Looking for :
#   ... ARRRRGH : TensorFlow doesn't support cuda-10.1 :: SUPER ANNOYING
# Not :
#   Executing op MatMul in device /job:localhost/replica:0/task:0/device:CPU:0



{% endhighlight %}
